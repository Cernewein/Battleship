<!DOCTYPE html>

<html>

    <head>

        <meta charset="utf-8" />

        <title>Battleships</title>
        <script src="https://code.jquery.com/jquery-3.1.1.js"
			  integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
			  crossorigin="anonymous"></script>
			  <style type="text/css">
			  	h1 {
			  		text-align: center;
			  		background-color: #222222;
			  		color: red;
			  	}
			  	td {
					height:10px;
					width: 10px;
					text-align: center;
				}
				table {
					width: 45%;
				}
				table, td, th {
					border: 1px solid black;
					border-collapse: collapse;
				}
			  </style>

    </head>

 

    <body>

        <h1>Battleships</h1>
        <!--<p><input type="button" value="Embêter le serveur" id="poke" /></p>-->

		 <table  align="left">
		 <tbody id="adversaire">
		 <tr><td colspan=10>Votre adversaire</td></tr>
		  <tr><td></td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td></tr>
		  <tr id="test1"><td>1</td ><td id="test"> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>2</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>3</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>4</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>5</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>6</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>7</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>8</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>9</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>10</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		 </tbody>
		 </table>

		 <table  align="right">
		 <tbody id="joueur" >
		 <tr><td colspan=10>Votre jeu</td></tr>
		  <tr><td></td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td></tr>
		  <tr><td>1</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>2</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>3</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>4</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>5</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>6</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>7</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>8</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>9</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		  <tr><td>10</td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
		 </tbody>
		 </table>
        <script src="/socket.io/socket.io.js"></script>
        <script>

            var socket = io.connect('http://localhost:8080');
            /*socket.on('message', function(message) {
        		alert('Le serveur a un message pour vous : ' + message);
        	})
			$('#poke').click(function () {

                socket.emit('message', 'Salut serveur, ça va ?');

            })*/
            $('td').click(function (event) {
            	//$(event.target).css("background-color", "red");
            	var col = $(this).parent().children().index($(this));
				var row = $(this).parent().parent().children().index($(this).parent());
				var id = event.target.parentNode.parentNode.id;
				if (col>=1 && row>=1) {
					console.log('On est bien dans le if');
					socket.emit('cell', {"id":id,"col":col,"row":row});
				}
            	

            	//$('#joueur').css("background-color", "red");
            });
            socket.on('retour',function(retour){
            	var id = retour.id;
            	var col = retour.col+1;
            	var row = retour.row+1; 
            	$("#"+id+" tr:nth-child("+row+") td:nth-child("+col+")").css("background-color", 'red');
            	console.log(row + ' ' + col);
            });
        </script>

    </body>

</html>